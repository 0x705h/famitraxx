/*
	Famitraxx

	2o13 bsasarg.

	coded by munshkr & alekhin0w
*/

/* Includes */
#include "neslib.h"
#include "palettes.h"

const unsigned char credits[149]={
0x01,0x00,0x01,0xe2,0x8e,0x6b,0x88,0x86,0x88,0x8d,0x80,0x8b,0x00,0x7d,0x7b,0x00,
0x6c,0x8f,0x84,0x82,0x6d,0x6b,0x6e,0x8c,0x00,0x86,0x80,0x8c,0x84,0x00,0x01,0x26,
0x7e,0x7f,0xf2,0xf0,0xf1,0xf1,0x00,0x83,0x84,0x8d,0x88,0x6c,0x00,0x86,0x6b,0x80,
0x82,0x87,0x84,0x6f,0x00,0x01,0x6b,0x8d,0x84,0x6c,0x00,0x82,0x8e,0x8d,0x6f,0x84,
0x6b,0x6c,0x88,0x8e,0x8d,0x00,0x81,0x7c,0x00,0x01,0x2e,0x6c,0x87,0x88,0x6b,0x6e,
0x00,0x01,0x7a,0x8d,0x84,0x6c,0x00,0x8c,0x6e,0x6c,0x88,0x82,0x00,0x81,0x7c,0x00,
0x01,0x33,0x6b,0x88,0x82,0x87,0x80,0x6b,0x83,0x00,0xfc,0x8a,0x6e,0x8b,0x8e,0x6b,
0xfd,0x00,0x80,0x6b,0x8c,0x88,0x89,0x8e,0x00,0x01,0xfe,0x00,0x01,0x07,0xff,0x01,
0x0f,0xf5,0x01,0x07,0x5f,0x01,0x07,0xff,0x01,0x07,0xf5,0x01,0x07,0xff,0x01,0x07,
0x0f,0x01,0x07,0x01,0x00
};

const unsigned char screen_bin[] = {
	0x20, 0x20, 0x82, 0xb5, 0x8c, 0x6e, 0x8d, 0x6c, 0x87, 0x8a, 0x6b, 
	0x20, 0x20, 0x17, 0xc5, 0x20, 0x20, 0x23, 0x80, 0x8b, 0x84, 0x8a, 
	0x87, 0x88, 0x8d, 0xf0, 0x7a, 0xb0, 0x20, 0x20, 0x1e, 0xc0, 0x20, 
	0x20, 0xff, 0x20, 0xff, 0x20, 0xcf, 0x54, 0x05, 0x05, 0x02, 0x45, 
	0x51, 0x20, 0x20, 0x01, 0x55, 0x0a, 0x55, 0x50, 0x10, 0x04, 0x55, 
	0x20, 0x55, 0x20, 0x20, 0x04, 0x55, 0x20, 0x55, 0x11, 0x20, 0x20, 
	0x03, 0x15, 0x20, 0x05, 0x55, 0x50, 0x40, 0x50, 0x14, 0x20, 0x20, 
	0x02, 0x04, 0x45, 0x45, 0x01, 0x11, 0x20, 0x20, 0x05, 0x45, 0x55, 
	0x51, 0x40, 0x50, 0x20, 0x20, 0x04, 0x05, 0x05, 0x01, 0x01, 0x01, 
	0x20
};
// global variables -- avoid local variables because they're slower!
unsigned char i,j;
extern const unsigned char music_title_data[];

void write_string (char *str)
{
	*((unsigned char*)0x2006) = 0x20;
	*((unsigned char*)0x2006) = 0x41;     //put the "hallo nes" characters in name table 0 
	
	while (*str)
	{
		*((unsigned char*)0x2007) = *(str + 10);
		str++;
	}
	*((unsigned char*)0x2006) = 0x20;
	*((unsigned char*)0x2006) = 0x4f;  //puts a 2 after "hallo nes", Just expirimenting here.
	*((unsigned char*)0x2007) = 0x32;
}


void fade_screen_in(const unsigned char *pal)
{
	for(i=0;i<16;i++)
	{
		ppu_waitnmi();
		if(!(i&3))
		{
			pal_fade_to_bg(pal);
			pal_fade_to_spr(pal);
		}
	}
}



void fade_screen_out(void)
{
	for(i=0;i<16;i++)
	{
		ppu_waitnmi();
		if(!(i&3)) pal_fade();
	}
}

void screen(void)
{
	ppu_off();
	pal_clear();
	unrle_vram(screen_bin,0x2000);
	//write_string("abcdefghijklmnopqrstuvwxyzABCDEFHIJKLMNOPQRSTUVWXYZ");
	//write_string("Hello, NES!");
	ppu_on_bg();
	fade_screen_in(palTitleBG);

	music_play(music_title_data);
	j=150;

	while(1)
	{

		ppu_waitnmi();
		i=pad_trigger();
		//j--;
		if(!j||(i&PAD_START)) break;
	}

	fade_screen_out();
}

/* Program entry */
int main()
{
	screen();

	while(1);
	return 0;
}
